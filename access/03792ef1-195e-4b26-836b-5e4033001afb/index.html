<!doctype html>

<html lang="uz">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/assets/favicon.ico">
    <title>DMED</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            color-scheme: light;
            font-family: 'Inter';
            background: #ffffff;
            color: #1c1f23;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-height: 100vh;
            background: #ffffff;
            display: flex;
            justify-content: center;
        }

        .page {
            width: min(1100px, 100%);
            min-height: 100vh;
            height: auto;
            padding: 64px 24px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* gap: 32px;    */
        }

        header {
            width: 100%;
            display: grid;
            grid-template-columns: 1fr auto;
            align-items: center;
            gap: 16px;
        }

        .logo {
            height: 70px;
            width: auto;
        }

        .language-switcher {
            position: relative;
            justify-self: end;
        }

        .language-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 999px;
            border: 1px solid #d9d9d9;
            background: #fff;
            /* font-size: 15px; */
            font-weight: 500;
            color: #334155;
            cursor: pointer;
            transition: all 0.2s;
        }

        .language-pill:hover {
            border-color: #cbd5e1;
            background: #f8fafc;
        }

        .language-pill:focus-visible {
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 146, 255, 0.15);
            border-color: #3b82f6;
        }

        .flag-icon {
            width: 24px;
            height: 24px;
            /* border-radius: 50%; */
            object-fit: cover;
            display: block;
        }

        .language-menu {
            list-style: none;
            margin: 8px 0 0;
            padding: 6px;
            border-radius: 12px;
            border: 1px solid #d9d9d9;
            background: #fff;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            position: absolute;
            right: 0;
            min-width: 160px;
            display: flex;
            flex-direction: column;
            gap: 2px;
            z-index: 10;
        }

        .language-menu[hidden] {
            display: none;
        }

        .language-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            border-radius: 8px;
            font-size: 14px;
            color: #334155;
            cursor: pointer;
            border: none;
            background: none;
            text-align: left;
            width: 100%;
            font-weight: 500;
        }

        .language-option:disabled {
            background: #f1f5f9;
            color: #0f172a;
            cursor: default;
        }

        .language-option:not(:disabled):hover {
            background: #f8fafc;
        }

        .hero {
            row-gap: 24px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
            margin-top: clamp(20px, 5vw, 60px);
            width: 100%;
        }

        .hero h1 {
            font-size: clamp(18px, 3vw, 24px);
            margin: 0;
            font-weight: 600;
            color: #0f172a;
            line-height: 1.4;
            max-width: 420px;
        }

        .pin-inputs {
            display: inline-flex;
            align-items: center;
            flex-wrap: nowrap;
            grid-template-columns: repeat(4, 62px);
            gap: 8px;
            /* justify-content: center; */
            margin-top: 8px;
        }

        .pin-inputs input {
            width: 59.01px;
            height: 40.19px;
            padding: 7px 8px;
            border-radius: 10px;
            border: 1px solid #d9d9d9;
            font-size: 12px;
            font-family: 'Inter';
            text-align: center;
            font-weight: 400;
            color: #0f172a;
            background: #fff;
            transition: all 0.2s;
        }

        .pin-inputs input:hover {
            border-color: #409fff;
        }

        .pin-inputs input:focus {
            outline: none;
            border-color: #1681ff;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .pin-inputs.error input {
            border-color: #ff4d4f;
        }

        .pin-inputs.error input:focus {
            border-color: #ff4d4f;
            box-shadow: 0 0 0 3px rgba(255, 77, 79, 0.15);
        }

        .pin-input-wrapper {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0;
        }

        .error-message {
            color: #ff4d4f;
            font-size: 14px;
            font-weight: 400;
            margin: 0;
            padding-top: 8px;
            text-align: left;
            height: 0;
            overflow: hidden;
            opacity: 0;
            transition: height 0.2s, opacity 0.2s, padding 0.2s;
        }

        .error-message.visible {
            height: auto;
            opacity: 1;
        }
        
        .submit-btn {
            width: 260px; /* 4*56 + 3*14 = 224 + 42 = 266 */
            height: 40;
            padding: 7px;
            border-radius: 10px;
            border: 1px solid #d9d9d9;
            margin-top: 16px;
            background: rgba(0, 0, 0, 0.04);
            color: rgba(0, 0, 0, 0.25);
            font-size: 16px;
            font-family: 'Inter';
            font-kerning: auto;
            font-weight: 400;
            cursor: not-allowed;
            transition: all 0.2s;
        }

        .pin-illustration {
            width: 100%;
            max-width: 380px;
            display: block;
            margin: clamp(32px, 6vw, 64px) auto 0;
        }

        @media (max-width: 640px) {
            .page {
                padding: 16px 24px;
                /* gap: 8; */
                row-gap: 24px;
            }

            header {
                align-items: flex-start;
            }

            .logo {
                height: 38px;
            }

            .language-pill {
                padding: 8px;
                border-radius: 50%;
            }

            .language-label {
                display: none;
            }

            .hero {
                margin-top: 20px;
                gap: 20px;
            }

            .hero h1 {
                font-size: 20px;
                padding: 0 8px;
            }

            .pin-inputs {
                margin-top: 14px;
                margin-bottom: 10px;
                grid-template-columns: repeat(4, 52px);
                gap: 8px;
            }

            .pin-inputs input {
                margin: 0;
                width: 62px;
                height: 40px;
                font-size: 18px;
            }

            .submit-btn {
                width: 100%;
                max-width: 330px;
                height: 48px;
                margin-top: 24px;
            }

            .pin-illustration {
                max-width: 98%;
                margin-top: 100px;
                padding: 7px 8px;
            }
        }
    </style>
</head>

<body>
    <main class="page">
        <header>
            <img class="logo" src="/assets/logo.svg" alt="DMED logo">
            <div class="language-switcher">
                <button class="language-pill" type="button" aria-expanded="false" aria-haspopup="true">
                    <img class="flag-icon" src="/assets/lang/uz.svg" alt="Uzbek flag">
                    <span class="language-label">O'zbekcha</span>
                </button>
                <ul class="language-menu" hidden>
                    <li><button class="language-option" data-lang="ru" type="button"><img class="flag-icon" src="/assets/lang/ru.svg" alt="Russian flag"><span>Русский</span></button></li>
                    <li><button class="language-option" data-lang="uz" type="button"><img class="flag-icon" src="/assets/lang/uz.svg" alt="Uzbek flag"><span>O'zbekcha</span></button></li>
                    <li><button class="language-option" data-lang="en" type="button"><img class="flag-icon" src="/assets/lang/en.svg" alt="English flag"><span>English</span></button></li>
                </ul>
            </div>
        </header>

        <section class="hero">
            <h1 data-i18n="heading">Hujjatni ko'rish uchun PIN - kodni kiriting</h1>
            <div class="pin-input-wrapper">
                <section class="pin-inputs" aria-label="PIN code inputs">
                    <input inputmode="numeric" maxlength="1" autocomplete="one-time-code">
                    <input inputmode="numeric" maxlength="1" autocomplete="one-time-code">
                    <input inputmode="numeric" maxlength="1" autocomplete="one-time-code">
                    <input inputmode="numeric" maxlength="1" autocomplete="one-time-code">
                </section>
                <p class="error-message" data-i18n="error">Hujjat topilmadi</p>
            </div>

            <button class="submit-btn" type="button" disabled data-i18n="button">Ochish</button>
        </section>

        <img src="/assets/image.svg" alt="PIN code location illustration" class="pin-illustration">
            
    </main>

    <script>
        const inputs = Array.from(document.querySelectorAll('.pin-inputs input'));
        const pinInputsContainer = document.querySelector('.pin-inputs');
        const headingEl = document.querySelector('[data-i18n="heading"]');
        const buttonEl = document.querySelector('[data-i18n="button"]');
        const errorEl = document.querySelector('[data-i18n="error"]');
        const languagePill = document.querySelector('.language-pill');
        const languageMenu = document.querySelector('.language-menu');
        const languageButtons = document.querySelectorAll('.language-option');

        const languages = {
            uz: {
                label: "O'zbekcha",
                flag: '/assets/lang/uz.svg',
                heading: "Hujjatni ko'rish uchun PIN - kodni kiriting",
                button: 'Ochish',
                error: 'Incorrect PIN code'
            },
            ru: {
                label: 'Русский',
                flag: '/assets/lang/ru.svg',
                heading: 'Введите PIN-код, чтобы просмотреть документ',
                button: 'Открыть',
                error: 'Incorrect PIN code'
            },
            en: {
                label: 'English',
                flag: '/assets/lang/en.svg',
                heading: 'Enter the PIN code to view the document',
                button: 'Open',
                error: 'Incorrect PIN code'
            }
        };

        function sanitize(value) {
            return value.replace(/\D/g, '');
        }

        function clearError() {
            pinInputsContainer.classList.remove('error');
            errorEl.classList.remove('visible');
        }

        function showError() {
            pinInputsContainer.classList.add('error');
            errorEl.classList.add('visible');
        }

        function handleInput(e) {
            const input = e.target;
            input.value = sanitize(input.value).slice(-1);

            if (input.value && input.nextElementSibling) {
                input.nextElementSibling.focus();
            }

            const pin = inputs.map(i => i.value).join('');
            if (pin.length === 4) {
                if (pin === "4187") {
                    setTimeout(() => {
                        inputs.forEach(input => {
                            input.value = '';
                        });
                        clearError();
                        window.location.href = "/el-docs/03792ef1-195e-4b26-836b-5e4033001afb";
                    }, 150);
                } else {
                    showError();
                }
            }
        }

        function handleKeyDown(e) {
            const input = e.target;
            // Clear error when user starts typing again
            if (e.key !== 'Tab') {
                clearError();
            }
            if (e.key === 'Backspace' && !input.value && input.previousElementSibling) {
                input.previousElementSibling.focus();
            }
        }

        function toggleMenu(forceState) {
            const shouldOpen = typeof forceState === 'boolean' ? forceState : languageMenu.hidden;
            languageMenu.hidden = !shouldOpen;
            languagePill.setAttribute('aria-expanded', String(shouldOpen));
        }

        function setLanguage(lang) {
            const data = languages[lang] || languages.uz;
            headingEl.textContent = data.heading;
            buttonEl.textContent = data.button;
            errorEl.textContent = data.error;
            languagePill.querySelector('.flag-icon').src = data.flag;
            languagePill.querySelector('.language-label').textContent = data.label;
            document.documentElement.lang = lang;

            languageButtons.forEach(btn => {
                btn.disabled = btn.dataset.lang === lang;
            });
        }

        languagePill.addEventListener('click', (event) => {
            event.stopPropagation();
            toggleMenu();
        });

        document.addEventListener('click', () => toggleMenu(false));

        languageButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                event.stopPropagation();
                setLanguage(button.dataset.lang);
                toggleMenu(false);
            });
        });

        inputs.forEach((input, idx) => {
            input.addEventListener('input', handleInput);
            input.addEventListener('keydown', handleKeyDown);
            input.dataset.index = idx;
        });

        inputs[0].focus();
        setLanguage('ru');
    </script>
</body>

</html>
